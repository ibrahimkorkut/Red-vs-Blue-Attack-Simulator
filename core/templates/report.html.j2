<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Cyber Research Lab Report</title>
  <style>
    body { font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; margin: 2rem; background: #0b1120; color: #e5e7eb; }
    h1, h2, h3 { color: #f97316; }
    .card { background: #020617; padding: 1.5rem; border-radius: 0.75rem; margin-bottom: 1rem; border: 1px solid #1f2937; }
    .badge { display: inline-block; padding: 0.25rem 0.6rem; border-radius: 999px; font-size: 0.75rem; margin-right: 0.3rem; }
    .badge-info { background: #0369a1; }
    .badge-low { background: #22c55e; }
    .badge-medium { background: #eab308; }
    .badge-high { background: #f97316; }
    .badge-critical { background: #ef4444; }
    table { width: 100%; border-collapse: collapse; margin-top: 0.5rem; }
    th, td { padding: 0.5rem; border-bottom: 1px solid #1f2937; text-align: left; font-size: 0.9rem; }
    th { background: #020617; }
    code { background: #111827; padding: 0.1rem 0.3rem; border-radius: 0.25rem; }
  </style>
</head>
<body>
  <h1>Cyber Research Lab Report</h1>

  <div class="card">
    <h2>Summary</h2>
    <p>Global risk score:
      <span class="badge badge-{{ 'critical' if report.summary.global_score >= 80 else 'high' if report.summary.global_score >= 60 else 'medium' if report.summary.global_score >= 40 else 'low' }}">
        {{ "%.1f"|format(report.summary.global_score) }}
      </span>
    </p>
    <p>Total events: <strong>{{ report.summary.total_events }}</strong></p>
    <p>Total detections: <strong>{{ report.summary.total_detections }}</strong></p>
  </div>

  <div class="card">
    <h2>Asset Scores</h2>
    {% if report.summary.asset_scores %}
      <table>
        <thead>
          <tr>
            <th>Asset</th>
            <th>Score</th>
          </tr>
        </thead>
        <tbody>
          {% for asset, score in report.summary.asset_scores.items() %}
          <tr>
            <td><code>{{ asset }}</code></td>
            <td>{{ "%.2f"|format(score) }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    {% else %}
      <p>No assets scored.</p>
    {% endif %}
  </div>

  <div class="card">
    <h2>Detections</h2>
    {% if report.detections %}
      <table>
        <thead>
          <tr>
            <th>Asset</th>
            <th>Category</th>
            <th>Severity</th>
            <th>Confidence</th>
            <th>Frequency</th>
          </tr>
        </thead>
        <tbody>
          {% for d in report.detections %}
          <tr>
            <td><code>{{ d.asset_id }}</code></td>
            <td>{{ d.category }}</td>
            <td>
              <span class="badge badge-{{ d.severity }}">
                {{ d.severity }}
              </span>
            </td>
            <td>{{ "%.2f"|format(d.confidence) }}</td>
            <td>{{ d.frequency }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    {% else %}
      <p>No detections generated.</p>
    {% endif %}
  </div>
</body>
</html>

